<!DOCTYPE html>
<html lang="ar">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Ù…ØªØ¬Ø± Ø§Ù„Ø¯ÙˆØ§Ø¬Ù† Ø§Ù„Ù…ØªØ·ÙˆØ±</title>
<style>
:root{ --main: #4CAF50; --secondary: #f44336; }
body{ margin:0; font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; direction:rtl; background:#f9f9f9; }
header{ background:var(--main); color:#fff; padding:15px 20px; display:flex; justify-content:space-between; align-items:center; sticky: top; position: sticky; z-index: 100; box-shadow: 0 2px 5px rgba(0,0,0,0.1); }
.container{ padding:20px; max-width: 1200px; margin: auto; }

/* Ø§Ù„Ø£Ø²Ø±Ø§Ø± ÙˆØ§Ù„Ø­Ù‚ÙˆÙ„ */
button{ background:var(--main); color:#fff; border:none; padding:10px 15px; cursor:pointer; border-radius:5px; transition: 0.3s; }
button:hover{ opacity: 0.8; }
.btn-del{ background: var(--secondary); }
input, select{ padding:10px; margin:5px 0; width:100%; border:1px solid #ddd; border-radius:5px; box-sizing: border-box; }

/* Ø§Ù„Ù…ØªØ¬Ø± ÙˆØ§Ù„Ø¨Ø­Ø« */
.search-bar{ margin-bottom: 20px; }
.products{ display:grid; grid-template-columns:repeat(auto-fit, minmax(220px, 1fr)); gap:20px; }
.card{ background:#fff; padding:15px; border-radius:12px; text-align:center; box-shadow: 0 4px 6px rgba(0,0,0,0.05); }
.card img{ width:100%; height:180px; object-fit: cover; border-radius:8px; background: #eee; }
.price{ font-weight: bold; color: var(--main); font-size: 1.2em; margin: 10px 0; }

/* Ø§Ù„Ø³Ù„Ø© */
.cart-box{ background: #fff; padding: 15px; border-radius: 10px; margin-bottom: 20px; border-right: 5px solid var(--main); }
.cart-item{ display: flex; justify-content: space-between; border-bottom: 1px inset #eee; padding: 5px 0; }

.admin-section{ background:#fff; padding:20px; margin-top:20px; border-radius:10px; border: 1px solid #ddd; }
.hide{ display:none; }
.flex{ display: flex; gap: 10px; align-items: center; }
</style>
</head>
<body>

<header>
  <h2 id="siteName">ğŸ” Ù…ØªØ¬Ø± Ø§Ù„Ø¯ÙˆØ§Ø¬Ù†</h2>
  <div>
    <button onclick="toggleCart()">ğŸ›’ Ø§Ù„Ø³Ù„Ø© (<span id="cartCount">0</span>)</button>
    <button onclick="showLogin()" style="background:rgba(255,255,255,0.2)">Ø§Ù„Ø¥Ø¯Ø§Ø±Ø©</button>
  </div>
</header>

<div class="container">

  <div id="cartSection" class="cart-box hide">
    <h3>ğŸ›’ Ø³Ù„Ø© Ø§Ù„Ù…Ø´ØªØ±ÙŠØ§Øª</h3>
    <div id="cartItems"></div>
    <hr>
    <div class="flex">
        <strong>Ø§Ù„Ù…Ø¬Ù…ÙˆØ¹: <span id="totalPrice">0</span> Ø¯ÙŠÙ†Ø§Ø±</strong>
        <button onclick="sendWhatsApp()">Ø¥Ø±Ø³Ø§Ù„ Ø§Ù„Ø·Ù„Ø¨ Ø¹Ø¨Ø± ÙˆØ§ØªØ³Ø§Ø¨ âœ…</button>
    </div>
  </div>

  <div class="search-bar">
    <input type="text" id="searchInput" placeholder="Ø§Ø¨Ø­Ø« Ø¹Ù† Ù…Ù†ØªØ¬..." oninput="loadProducts()">
  </div>

  <div class="products" id="products"></div>

  <div id="login" class="hide admin-section">
    <h3>ğŸ” Ø¯Ø®ÙˆÙ„ Ø§Ù„Ø¥Ø¯Ø§Ø±Ø©</h3>
    <input id="user" placeholder="Ø§Ø³Ù… Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…">
    <input id="pass" type="password" placeholder="ÙƒÙ„Ù…Ø© Ø§Ù„Ø³Ø±">
    <button onclick="login()">Ø¯Ø®ÙˆÙ„</button>
    <button class="btn-del" onclick="this.parentElement.classList.add('hide')">Ø¥Ù„ØºØ§Ø¡</button>
  </div>

  <div id="admin" class="hide admin-section">
    <h3>ğŸ›  Ù„ÙˆØ­Ø© Ø§Ù„ØªØ­ÙƒÙ…</h3>
    <div style="display:grid; grid-template-columns: 1fr 1fr; gap:20px;">
        <div>
            <h4>â• Ø¥Ø¶Ø§ÙØ© Ù…Ù†ØªØ¬</h4>
            <input id="pname" placeholder="Ø§Ø³Ù… Ø§Ù„Ù…Ù†ØªØ¬">
            <input id="pprice" type="number" placeholder="Ø§Ù„Ø³Ø¹Ø±">
            <label>Ø§Ø®ØªØ± ØµÙˆØ±Ø© Ø§Ù„Ù…Ù†ØªØ¬:</label>
            <input id="pimg" type="file" accept="image/*">
            <button onclick="addProduct()">Ø­ÙØ¸ Ø§Ù„Ù…Ù†ØªØ¬</button>
        </div>
        <div>
            <h4>ğŸ¨ Ø§Ù„Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª</h4>
            <input id="newName" placeholder="Ø§Ø³Ù… Ø§Ù„Ù…ÙˆÙ‚Ø¹ Ø§Ù„Ø¬Ø¯ÙŠØ¯">
            <input type="color" id="newColor" style="height:40px">
            <button onclick="saveSettings()">Ø­ÙØ¸ Ø§Ù„ØªØ¹Ø¯ÙŠÙ„Ø§Øª</button>
            <hr>
            <button class="btn-del" onclick="logout()">ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø®Ø±ÙˆØ¬</button>
        </div>
    </div>
  </div>
</div>

<script>
// --- ØªÙ‡ÙŠØ¦Ø© Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª ---
let admins = JSON.parse(localStorage.admins || '[{"u":"admin","p":"1234"}]');
let products = JSON.parse(localStorage.products || '[]');
let settings = JSON.parse(localStorage.settings || '{"name":"ğŸ” Ù…ØªØ¬Ø± Ø§Ù„Ø¯ÙˆØ§Ø¬Ù†","color":"#4CAF50"}');
let cart = [];
let isAdmin = false;

// ØªØ·Ø¨ÙŠÙ‚ Ø§Ù„Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª
function applySettings() {
    document.documentElement.style.setProperty("--main", settings.color);
    document.getElementById('siteName').innerText = settings.name;
}
applySettings();

// --- ÙˆØ¸Ø§Ø¦Ù Ø§Ù„Ù…ØªØ¬Ø± ---
function loadProducts() {
    const grid = document.getElementById('products');
    const search = document.getElementById('searchInput').value.toLowerCase();
    grid.innerHTML = "";

    products.filter(p => p.name.toLowerCase().includes(search)).forEach((p, i) => {
        grid.innerHTML += `
        <div class="card">
            <img src="${p.img || 'https://via.placeholder.com/150'}" onerror="this.src='https://via.placeholder.com/150'">
            <h4>${p.name}</h4>
            <div class="price">${p.price} Ø¯ÙŠÙ†Ø§Ø±</div>
            <button onclick="addToCart(${i})">Ø¥Ø¶Ø§ÙØ© Ù„Ù„Ø³Ù„Ø© ğŸ›’</button>
            ${isAdmin ? `<button class="btn-del" onclick="delProduct(${i})">Ø­Ø°Ù</button>` : ""}
        </div>`;
    });
}

// --- Ø§Ù„Ø³Ù„Ø© ---
function addToCart(index) {
    cart.push(products[index]);
    updateCart();
}

function updateCart() {
    const itemsDiv = document.getElementById('cartItems');
    const countSpan = document.getElementById('cartCount');
    const totalSpan = document.getElementById('totalPrice');
    
    itemsDiv.innerHTML = "";
    let total = 0;
    
    cart.forEach((item, i) => {
        total += parseFloat(item.price);
        itemsDiv.innerHTML += `
        <div class="cart-item">
            <span>${item.name}</span>
            <span>${item.price} Ø¯ÙŠÙ†Ø§Ø± <button onclick="removeFromCart(${i})" style="padding:2px 5px; background:red">X</button></span>
        </div>`;
    });
    
    countSpan.innerText = cart.length;
    totalSpan.innerText = total;
}

function removeFromCart(i) {
    cart.splice(i, 1);
    updateCart();
}

function toggleCart() {
    document.getElementById('cartSection').classList.toggle('hide');
}

function sendWhatsApp() {
    if(cart.length === 0) return alert("Ø§Ù„Ø³Ù„Ø© ÙØ§Ø±ØºØ©!");
    let msg = `Ø·Ù„Ø¨ Ø¬Ø¯ÙŠØ¯ Ù…Ù† Ø§Ù„Ù…ØªØ¬Ø±:%0A`;
    cart.forEach(item => msg += `- ${item.name} (${item.price} Ø¯ÙŠÙ†Ø§Ø±)%0A`);
    msg += `%0A*Ø§Ù„Ù…Ø¬Ù…ÙˆØ¹: ${document.getElementById('totalPrice').innerText} Ø¯ÙŠÙ†Ø§Ø±*`;
    window.open(`https://wa.me/9647800000000?text=${msg}`); // Ø§Ø³ØªØ¨Ø¯Ù„ Ø§Ù„Ø±Ù‚Ù… Ø¨Ø±Ù‚Ù…Ùƒ
}

// --- ÙˆØ¸Ø§Ø¦Ù Ø§Ù„Ø¥Ø¯Ø§Ø±Ø© ---
function showLogin() { document.getElementById('login').classList.remove('hide'); }

function login() {
    const u = document.getElementById('user').value;
    const p = document.getElementById('pass').value;
    if(admins.find(a => a.u === u && a.p === p)) {
        isAdmin = true;
        document.getElementById('login').classList.add('hide');
        document.getElementById('admin').classList.remove('hide');
        loadProducts();
    } else alert("Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø¯Ø®ÙˆÙ„ Ø®Ø§Ø·Ø¦Ø©");
}

function addProduct() {
    const file = document.getElementById('pimg').files[0];
    const name = document.getElementById('pname').value;
    const price = document.getElementById('pprice').value;

    if(!name || !price) return alert("Ø£Ø¯Ø®Ù„ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª ÙƒØ§Ù…Ù„Ø©");

    if(file) {
        const reader = new FileReader();
        reader.onload = function(e) {
            saveAndRefresh(name, price, e.target.result);
        };
        reader.readAsDataURL(file);
    } else {
        saveAndRefresh(name, price, "");
    }
}

function saveAndRefresh(name, price, imgData) {
    products.push({name, price, img: imgData});
    localStorage.products = JSON.stringify(products);
    loadProducts();
    alert("ØªÙ…Øª Ø§Ù„Ø¥Ø¶Ø§ÙØ© Ø¨Ù†Ø¬Ø§Ø­");
}

function delProduct(i) {
    if(confirm("Ù‡Ù„ Ø£Ù†Øª Ù…ØªØ£ÙƒØ¯ Ù…Ù† Ø§Ù„Ø­Ø°ÙØŸ")) {
        products.splice(i, 1);
        localStorage.products = JSON.stringify(products);
        loadProducts();
    }
}

function saveSettings() {
    settings.name = document.getElementById('newName').value || settings.name;
    settings.color = document.getElementById('newColor').value;
    localStorage.settings = JSON.stringify(settings);
    location.reload();
}

function logout() {
    isAdmin = false;
    document.getElementById('admin').classList.add('hide');
    loadProducts();
}

// Ø§Ù„ØªØ´ØºÙŠÙ„ Ø§Ù„Ø£ÙˆÙ„ÙŠ
loadProducts();
</script>

</body>
</html>
